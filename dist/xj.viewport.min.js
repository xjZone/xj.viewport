/** xj.viewport(视窗属性设置) | V0.3.0 | Apache Licence 2.0 | 2015-2021 © XJ.Chen | https://github.com/xjZone/xj.viewport */
!function(a,b){"function"!=typeof define||void 0===define.amd&&void 0===define.cmd?"undefined"!=typeof module&&"object"==typeof exports?module.exports=b():(a=a||self,a.xj||(a.xj={}),a.xj.viewport=b()):define(b)}(this,function(){"use strict";var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:global,c="0.3.0",e={manual:!1,betkbd:240},f={minWidth:0,minHeight:0,onlyMobile:!0,fillScreen:!1,delayReset:500,initialScale:"auto",minimumScale:"none",maximumScale:"none",userScalable:"none",userScalable:"none",targetDensitydpi:"",viewportFit:"",resize:!0,width:"auto",height:"auto"};return void 0===a.xj&&(a.xj={}),void 0===a.xj.viewportReturn&&(a.xj.viewportReturn={}),void 0!==a.xj.viewportReturn[c]?a.xj.viewportReturn[c]:(void 0===a.xj.viewportConfig&&(a.xj.viewportConfig={}),void 0===a.xj.viewportOption&&(a.xj.viewportOption={}),void 0!==a.xj.viewportConfig[c]&&Object.keys(a.xj.viewportConfig[c]).forEach(function(b){e[b]=a.xj.viewportConfig[c][b]}),void 0!==a.xj.viewportOption[c]&&Object.keys(a.xj.viewportOption[c]).forEach(function(b){f[b]=a.xj.viewportOption[c][b]}),g=a,h=g.document,i=h.documentElement,j=h.querySelector('meta[name="viewport"]'),k=/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent),l=k&&/Apple/i.test(navigator.vendor)?!0:!1,m=function(){j.setAttribute("content","width=device-width,initial-scale=1")},n=function(){return k===!1?g.innerWidth>g.innerHeight?"landscape":g.innerWidth<g.innerHeight?"portrait":"squared":l===!0?i.clientWidth>i.clientHeight?"landscape":i.clientWidth<i.clientHeight?"portrait":"squared":screen.width>screen.height?"landscape":screen.width<screen.height?"portrait":"squared"},o=/Firefox/i.test(navigator.userAgent)===!0?"MozUserModify":"webkitUserModify",p=function(a,b){return g.getComputedStyle(a,b?b:null)},q=function(a){return/^input|textarea$/i.test(a.nodeName)===!0?!1:a.isContentEditable===!0||void 0===h.documentMode&&/write/i.test(p(a)[o])===!0?!0:!1},r=function(){return parseFloat(j.content.match(/initial-scale=([^,]+)/i)[1].trim())},s=!0,function(a,b){try{a=h.createElement("input"),a.type="color",a.value="!",b="color"===a.type&&"!"!==a.value}catch(c){}b===!1&&(s=!1)}(null,!1),t=function(){if(k===!1||l===!0)return!1;var a=h.activeElement;if(null===a||1!==a.nodeType)return!1;if(/^input|textarea$/i.test(a.nodeName)===!0){if(/color/i.test(a.type)===!0&&s===!0)return!1;if(/textarea|text|email|tel|url|number|search|password|date|time|week|month|range|color/i.test(a.type)===!1)return!1;if(a.readOnly===!0||a.disabled===!0||a.hasAttribute("readOnly")===!0||a.hasAttribute("disabled")===!0)return!1}return q(a)===!1?!1:screen.height-u.height()*r()<e.betkbd?!1:!0},u={version:c,element:j,orientation:n,softKeyboard:t,width:function(){return Math.round(i.clientWidth)},height:function(){return Math.round(g.innerHeight/g.innerWidth*i.clientWidth)},get:function(){return j.getAttribute("content")},set:function(a){var c,d,e,h,i,o,p,q,r,s,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,b={};Object.keys(f).forEach(function(a){b[a]=f[a]}),null!==a&&"object"==typeof a&&Object.keys(a).forEach(function(c){b[c]=a[c]}),c=b.minWidth,d=b.minHeight,e=b.onlyMobile,h=b.fillScreen,i=b.delayReset,o=b.initialScale,p=b.minimumScale,q=b.maximumScale,r=b.userScalable,s=b.targetDensitydpi,v=b.viewportFit,w=b.resize,x=b.width,y=b.height,(k!==!1||e!==!0)&&(z=u.width(),A=u.height(),B="",C="",D=1,E=1,F=1,"auto"===x&&(0!==c&&0===d&&c>z?(C=c,D=z/c):0===c&&0!==d&&d>A?(C=Math.round(d/A*z),D=A/d):0!==c&&0!==d&&(c>z||d>A?(c>z&&(E=z/c),d>A&&(F=A/d)):h===!0&&(z>c&&(E=z/c),A>d&&(F=A/d)),(1!==E||1!==F)&&(C=F>=E?c:Math.round(d/A*z),D=Math.min(E,F)))),B="width=",B+="auto"!==x?x:""===C?"device-width":C,B+=",initial-scale="+("auto"===o?D:initialScale),"none"!==p&&(B+=",minimum-scale="+("auto"===p?D:p)),"none"!==q&&(B+=",maximum-scale="+("auto"===q?D:q)),"none"!==r&&(B+=",user-scalable="+r),"auto"!==y&&(B+=",height="+y),""!==v&&(B+=",viewport-fit="+v),""!==s&&(B+=",target-densitydpi="+s),j.setAttribute("content",B),w!==!1&&(G=u.height(),H=0/0,I=n(),J=0,K=void 0,L=!1,g.addEventListener("resize",function(){return k===!1?(m(),b.resize=!1,u.set(b),void 0):((l!==!1||L!==!0)&&(l!==!1||t()!==!0)&&(clearTimeout(K),K=setTimeout(function(){H=u.height(),J=n(),J===I&&H+4>=G||(J!==I||G>H+4)&&(l===!1&&(L=!0),m(),L=!1,b.resize=!1,u.set(b),g.dispatchEvent(new Event("resize",{bubbles:!0,cancelable:!0})),G=u.height(),I=J)},i)),void 0)},!0)))}},e.manual===!1&&j.hasAttribute("xj-viewport")&&(v=eval("("+j.getAttribute("xj-viewport")+")"),void 0!==v&&null!==v&&"object"==typeof v&&u.set(v)),a.xj.viewportReturn[c]=u)});
